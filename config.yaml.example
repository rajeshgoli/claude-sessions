# Claude Session Manager Configuration
# Copy this file to config.yaml and fill in your values

server:
  host: "127.0.0.1"
  port: 8420

paths:
  log_dir: "/tmp/claude-sessions"
  state_file: "/tmp/claude-sessions/sessions.json"

monitor:
  # Seconds of inactivity before sending idle notification
  idle_timeout: 300
  # How often to check for new output (seconds)
  poll_interval: 1.0
  # Notification settings - control which events to notify about
  notify:
    errors: false              # Notify on error patterns (usually noise)
    permission_prompts: true   # Notify when Claude needs permission
    completion: false          # Notify when task appears complete
    idle: true                 # Notify when session is idle

telegram:
  # Bot token from @BotFather (required for Telegram integration)
  token: "YOUR_BOT_TOKEN_HERE"
  # Optional: restrict bot to specific chat IDs (leave empty to allow all)
  allowed_chat_ids: []
  # allowed_chat_ids:
  #   - 123456789
  #   - 987654321

email:
  # Paths to email harness config files
  # Leave empty to use defaults from ../claude-email-automation/
  smtp_config: ""
  imap_config: ""

services:
  # Office automation service (for /password command and other utilities)
  office_automate_url: "http://192.168.5.140:8080"

# Multi-agent coordination settings
claude:
  # Command to spawn Claude Code sessions (user-controlled, agents cannot override)
  command: "claude"
  # Command-line arguments (user-controlled, agents cannot override)
  args:
    - "--bypass-permissions"
  # Default model for spawned sessions (agent can override with --model flag)
  default_model: "sonnet"

child_agents:
  # Auto-completion detection
  auto_complete:
    enabled: true
    idle_timeout: 600  # Seconds (10 minutes)
    detect_completion_phrases: true
    completion_patterns:
      - "complete"
      - "done"
      - "finished"
      - "all tests pass"

  # Cleanup behavior
  cleanup:
    auto_kill_on_complete: false      # Keep tmux session running
    auto_archive_transcript: true     # Save transcript on completion
    archive_path: "/tmp/claude-sessions/archives"

  # Parent notifications (via sending text to parent's Claude input)
  notifications:
    notify_parent_on_complete: true
    notify_parent_on_error: true
    notify_parent_on_idle: true  # When --wait timeout reached

  # Progress tracking (auto-detected from transcript)
  progress:
    enable_token_tracking: true     # Approximate from transcript length
    enable_tool_tracking: true      # Count tool calls in transcript
    snapshot_interval: 30           # Seconds between checks

# Session defaults
sessions:
  default_working_dir_behavior: "inherit"  # inherit | specify
  inherit_environment_vars:
    - "SSH_AUTH_SOCK"
    - "PATH"
  naming:
    pattern: "{friendly_name}"               # e.g., task1042-fix
    fallback: "child-{short_id}"             # e.g., child-abc123
